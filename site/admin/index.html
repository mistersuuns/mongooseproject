<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Content Manager</title>
  <style>
    /* Spacing system using CSS custom properties */
    :root {
      --spacing-xs: 0.25rem;   /* 4px */
      --spacing-sm: 0.5rem;    /* 8px */
      --spacing-md: 0.625rem;  /* 10px */
      --spacing-lg: 1.125rem;  /* 18px */
      --spacing-xl: 1.5rem;    /* 24px */
    }

    /* Hide Decap logo/icon completely */
    #nc-root img,
    #nc-root svg,
    img[src*="decap"],
    img[src*="bridge"],
    svg[class*="logo"],
    [class*="logo"] img,
    [class*="logo"] svg,
    [class*="nc-authPage"] img,
    [class*="nc-authPage"] svg,
    [class*="nc-authPage-header"] img,
    [class*="nc-authPage-header"] svg,
    header img,
    header svg,
    [class*="nc-authPage-header"] {
      display: none !important;
      visibility: hidden !important;
    }
    
    /* Hide Decap text/heading */
    #nc-root [class*="nc-authPage"] h1,
    #nc-root [class*="nc-authPage"] [class*="title"],
    #nc-root [class*="nc-authPage-header"] h1,
    #nc-root [class*="nc-authPage-header"] [class*="title"] {
      display: none !important;
      visibility: hidden !important;
    }

    /* Invitation message - gap to signup button */
    .decapbridge-invite-copy {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 1.3125rem; /* 21px (50% larger than 14px) */
      color: #1e293b;
      text-align: center;
      margin: 0 !important;
      margin-bottom: 1.125rem !important; /* 18px - base gap */
      padding: 0 !important;
      max-width: 32.5rem; /* 520px */
    }

    /* Wrapper - center buttons, account for parent padding */
    .decapbridge-signup-wrap {
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      margin: 0 !important;
      padding: 0 !important;
      gap: 0 !important;
    }

    /* Signup button - fit to content, gap to login is HALF of text-to-signup gap (9px = 18px/2) */
    .decapbridge-signup-btn {
      width: fit-content !important;
      min-width: fit-content !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      background: #00c7b7 !important;
      color: white !important;
      padding: 0.75rem 1.5rem !important; /* 12px 24px */
      border: none !important;
      border-radius: 0.25rem !important; /* 4px */
      font-size: 1rem !important; /* 16px */
      font-weight: 600 !important;
      cursor: pointer !important;
      margin: 0 auto !important;
      margin-bottom: 0.5625rem !important; /* 9px = half of 18px */
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    }

    .decapbridge-signup-btn:hover {
      background: #00a896 !important;
    }

    /* Systematically remove ALL spacing from login button and its containers */
    .decapbridge-signup-wrap + *,
    .decapbridge-signup-wrap ~ * {
      margin-top: 0 !important;
      padding-top: 0 !important;
    }
    
    .decapbridge-signup-wrap + * button,
    .decapbridge-signup-wrap ~ button,
    .decapbridge-signup-wrap + form button,
    .decapbridge-signup-wrap ~ form button {
      margin-top: 0 !important;
      margin-bottom: 0 !important;
      padding-top: 0 !important;
    }
    
    /* Target login button specifically - remove all spacing, center text, and match signup width */
    button[type="submit"]:not(.decapbridge-signup-btn) {
      margin-top: 0 !important;
      margin-bottom: 0 !important;
      width: fit-content !important;
      min-width: fit-content !important;
      margin-left: auto !important;
      margin-right: auto !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      font-size: 1rem !important; /* match signup button font size */
      text-align: center !important;
    }
    
    /* Remove spacing from any parent containers */
    .decapbridge-signup-wrap + form,
    .decapbridge-signup-wrap ~ form,
    form:has(.decapbridge-signup-wrap) {
      margin: 0 !important;
      padding: 0 !important;
      gap: 0 !important;
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
    }
  </style>
</head>
<body>
  <!-- Mount point for Decap CMS -->
  <div id="nc-root"></div>
  <!-- Include the script that builds the page and powers Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js" defer></script>
  <script>
    // Wait for DecapBridge login form to render, then inject signup button
    function injectSignupButton() {
      // Look for the login button in various possible locations
      const selectors = [
        'button[type="submit"]',
        'button:contains("Log in")',
        'button:contains("Sign in")',
        'form button',
        '[data-testid="login-button"]',
        '.nc-authPage-button',
        'form > button'
      ];
      
      let loginButton = null;
      let loginForm = null;
      
      // Try to find login button
      for (const selector of selectors) {
        const buttons = document.querySelectorAll('button');
        for (const btn of buttons) {
          const text = btn.textContent.toLowerCase();
          if (text.includes('log') || text.includes('sign in') || text.includes('login')) {
            loginButton = btn;
            loginForm = btn.closest('form') || btn.parentElement;
            break;
          }
        }
        if (loginButton) break;
      }
      
      // If we found a login button, inject signup button above it
      if (loginButton && !document.querySelector('.decapbridge-signup-btn')) {
        const wrap = document.createElement('div');
        wrap.className = 'decapbridge-signup-wrap';

        const copy = document.createElement('div');
        copy.className = 'decapbridge-invite-copy';
        copy.innerHTML = "You've been invited to edit mongooseproject.org cms.<br>Create a password and sign in here.";

        const signupBtn = document.createElement('button');
        signupBtn.type = 'button';
        signupBtn.className = 'decapbridge-signup-btn';
        signupBtn.textContent = 'Create Password / Sign Up';
        signupBtn.onclick = function() {
          window.location.href = 'https://auth.decapbridge.com/sites/6924f3be-3af2-4b74-af00-7582d5a4e36c/pkce?signup=true';
        };

        wrap.appendChild(copy);
        wrap.appendChild(signupBtn);

        // Insert wrapper immediately above login button (same container)
        loginButton.parentElement.insertBefore(wrap, loginButton);
        
        // Systematically remove ALL spacing from login button and match signup button width
        // Do this immediately and also after a delay to catch any DecapBridge CSS
        function removeLoginSpacing() {
          // Get signup button width
          const signupBtn = document.querySelector('.decapbridge-signup-btn');
          const signupWidth = signupBtn ? signupBtn.offsetWidth + 'px' : 'fit-content';
          
          // Remove margin/padding from login button and match width
          loginButton.style.marginTop = '0';
          loginButton.style.marginBottom = '0';
          loginButton.style.paddingTop = '0';
          loginButton.style.width = signupWidth;
          loginButton.style.minWidth = signupWidth;
          loginButton.style.marginLeft = 'auto';
          loginButton.style.marginRight = 'auto';
          loginButton.style.display = 'inline-flex';
          loginButton.style.alignItems = 'center';
          loginButton.style.justifyContent = 'center';
          loginButton.style.textAlign = 'center';
          
          // Normalize label text to \"Log in\" if it's \"Login\"
          if (loginButton.textContent.trim().toLowerCase() === 'login') {
            loginButton.textContent = 'Log in';
          }
          
          // Remove spacing from parent containers and center
          const loginParent = loginButton.parentElement;
          if (loginParent) {
            loginParent.style.marginTop = '0';
            loginParent.style.paddingTop = '0';
            loginParent.style.gap = '0';
            loginParent.style.display = 'flex';
            loginParent.style.flexDirection = 'column';
            loginParent.style.alignItems = 'center';
          }
          
          // Remove spacing from form if it exists and center
          const loginForm = loginButton.closest('form');
          if (loginForm) {
            loginForm.style.marginTop = '0';
            loginForm.style.paddingTop = '0';
            loginForm.style.gap = '0';
            loginForm.style.display = 'flex';
            loginForm.style.flexDirection = 'column';
            loginForm.style.alignItems = 'center';
          }
        }
        
        removeLoginSpacing();
        setTimeout(removeLoginSpacing, 100);
        setTimeout(removeLoginSpacing, 500);
        
        // Add class to login button's parent for CSS targeting
        const loginContainer = loginButton.closest('form') || loginButton.parentElement;
        if (loginContainer) {
          loginContainer.classList.add('decapbridge-login-container');
        }
      }
    }
    
    // Try to inject button after page loads
    window.addEventListener('load', function() {
      // Try multiple times as DecapBridge might load async
      setTimeout(injectSignupButton, 500);
      setTimeout(injectSignupButton, 1000);
      setTimeout(injectSignupButton, 2000);
      setTimeout(injectSignupButton, 3000);
    });
    
    // Also watch for DOM changes (DecapBridge might render dynamically)
    const observer = new MutationObserver(function(mutations) {
      injectSignupButton();
    });
    
    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
  </script>
</body>
</html>
