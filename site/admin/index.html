<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Content Manager</title>
  <style>
    /* Spacing system using CSS custom properties */
    :root {
      --spacing-xs: 0.25rem;   /* 4px */
      --spacing-sm: 0.5rem;    /* 8px */
      --spacing-md: 0.625rem;  /* 10px */
      --spacing-lg: 1.125rem;  /* 18px */
      --spacing-xl: 1.5rem;    /* 24px */
    }

    /* Reduce Decap logo size */
    #nc-root img[src*="decap"],
    #nc-root img[src*="bridge"],
    #nc-root svg[class*="logo"],
    #nc-root [class*="logo"] img,
    #nc-root [class*="logo"] svg {
      max-height: 2rem !important;
      max-width: 12rem !important;
      height: auto !important;
      width: auto !important;
    }

    /* Invitation message */
    .decapbridge-invite-copy {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 0.875rem; /* 14px */
      color: #1e293b;
      text-align: center;
      margin: 0 0 var(--spacing-lg) 0; /* 18px bottom */
      max-width: 32.5rem; /* 520px */
    }

    /* Wrapper - accounts for parent padding/margins */
    .decapbridge-signup-wrap {
      display: flex;
      flex-direction: column;
      align-items: stretch;
      margin: 0;
      padding: 0;
    }

    /* Signup button - 10px gap to login button below */
    .decapbridge-signup-btn {
      width: 100% !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      background: #00c7b7 !important;
      color: white !important;
      padding: 0.75rem 1.5rem !important; /* 12px 24px */
      border: none !important;
      border-radius: 0.25rem !important; /* 4px */
      font-size: 1rem !important; /* 16px */
      font-weight: 600 !important;
      cursor: pointer !important;
      margin: 0 0 var(--spacing-md) 0 !important; /* 10px bottom gap to login */
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    }

    .decapbridge-signup-btn:hover {
      background: #00a896 !important;
    }

    /* Ensure login button has no top margin to respect our 10px gap */
    .decapbridge-signup-wrap + * button[type="submit"],
    .decapbridge-signup-wrap ~ button[type="submit"] {
      margin-top: 0 !important;
    }
  </style>
</head>
<body>
  <!-- Mount point for Decap CMS -->
  <div id="nc-root"></div>
  <!-- Include the script that builds the page and powers Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js" defer></script>
  <script>
    // Wait for DecapBridge login form to render, then inject signup button
    function injectSignupButton() {
      // Look for the login button in various possible locations
      const selectors = [
        'button[type="submit"]',
        'button:contains("Log in")',
        'button:contains("Sign in")',
        'form button',
        '[data-testid="login-button"]',
        '.nc-authPage-button',
        'form > button'
      ];
      
      let loginButton = null;
      let loginForm = null;
      
      // Try to find login button
      for (const selector of selectors) {
        const buttons = document.querySelectorAll('button');
        for (const btn of buttons) {
          const text = btn.textContent.toLowerCase();
          if (text.includes('log') || text.includes('sign in') || text.includes('login')) {
            loginButton = btn;
            loginForm = btn.closest('form') || btn.parentElement;
            break;
          }
        }
        if (loginButton) break;
      }
      
      // If we found a login button, inject signup button above it
      if (loginButton && !document.querySelector('.decapbridge-signup-btn')) {
        const wrap = document.createElement('div');
        wrap.className = 'decapbridge-signup-wrap';

        const copy = document.createElement('div');
        copy.className = 'decapbridge-invite-copy';
        copy.innerHTML = "You've been invited to edit mongooseproject.org cms.<br>Create a password and sign in here.";

        const signupBtn = document.createElement('button');
        signupBtn.type = 'button';
        signupBtn.className = 'decapbridge-signup-btn';
        signupBtn.textContent = 'Create Password / Sign Up';
        signupBtn.onclick = function() {
          window.location.href = 'https://auth.decapbridge.com/sites/6924f3be-3af2-4b74-af00-7582d5a4e36c/pkce?signup=true';
        };

        wrap.appendChild(copy);
        wrap.appendChild(signupBtn);

        // Insert wrapper immediately above login button (same container)
        loginButton.parentElement.insertBefore(wrap, loginButton);
        
        // Add class to login button's parent for CSS targeting if needed
        const loginContainer = loginButton.closest('form') || loginButton.parentElement;
        if (loginContainer) {
          loginContainer.classList.add('decapbridge-login-container');
        }
      }
    }
    
    // Try to inject button after page loads
    window.addEventListener('load', function() {
      // Try multiple times as DecapBridge might load async
      setTimeout(injectSignupButton, 500);
      setTimeout(injectSignupButton, 1000);
      setTimeout(injectSignupButton, 2000);
      setTimeout(injectSignupButton, 3000);
    });
    
    // Also watch for DOM changes (DecapBridge might render dynamically)
    const observer = new MutationObserver(function(mutations) {
      injectSignupButton();
    });
    
    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
  </script>
</body>
</html>
