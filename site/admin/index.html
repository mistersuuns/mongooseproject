<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Content Manager</title>
  <style>
    /* Style for injected signup button */
    .decapbridge-invite-copy {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 14px;
      color: #1e293b;
      text-align: center;
      /* increase space to signup button (~200%+) */
      margin: 0 0 18px 0;
      max-width: 520px;
    }
    .decapbridge-signup-wrap {
      display: flex;
      flex-direction: column;
      align-items: stretch;
      /* reduce gap between signup + login */
      margin: 0 0 2px 0;
    }
    .decapbridge-signup-btn {
      width: 100% !important;
      max-width: 100% !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      background: #00c7b7 !important;
      color: white !important;
      padding: 12px 24px !important;
      border: none !important;
      border-radius: 4px !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      cursor: pointer !important;
      margin: 0 !important;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    }
    .decapbridge-signup-btn:hover {
      background: #00a896 !important;
    }
  </style>
</head>
<body>
  <!-- Mount point for Decap CMS -->
  <div id="nc-root"></div>
  <!-- Include the script that builds the page and powers Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js" defer></script>
  <script>
    // Wait for DecapBridge login form to render, then inject signup button
    function injectSignupButton() {
      // Look for the login button in various possible locations
      const selectors = [
        'button[type="submit"]',
        'button:contains("Log in")',
        'button:contains("Sign in")',
        'form button',
        '[data-testid="login-button"]',
        '.nc-authPage-button',
        'form > button'
      ];
      
      let loginButton = null;
      let loginForm = null;
      
      // Try to find login button
      for (const selector of selectors) {
        const buttons = document.querySelectorAll('button');
        for (const btn of buttons) {
          const text = btn.textContent.toLowerCase();
          if (text.includes('log') || text.includes('sign in') || text.includes('login')) {
            loginButton = btn;
            loginForm = btn.closest('form') || btn.parentElement;
            break;
          }
        }
        if (loginButton) break;
      }
      
      // If we found a login button, inject signup button above it
      if (loginButton && !document.querySelector('.decapbridge-signup-btn')) {
        const wrap = document.createElement('div');
        wrap.className = 'decapbridge-signup-wrap';

        const copy = document.createElement('div');
        copy.className = 'decapbridge-invite-copy';
        copy.innerHTML = "You've been invited to edit mongooseproject.org cms.<br>Create a password and sign in here.";

        const signupBtn = document.createElement('button');
        signupBtn.type = 'button';
        signupBtn.className = 'decapbridge-signup-btn';
        signupBtn.textContent = 'Create Password / Sign Up';
        signupBtn.onclick = function() {
          window.location.href = 'https://auth.decapbridge.com/sites/6924f3be-3af2-4b74-af00-7582d5a4e36c/pkce?signup=true';
        };

        wrap.appendChild(copy);
        wrap.appendChild(signupBtn);

        // Insert wrapper immediately above login button (same container)
        loginButton.parentElement.insertBefore(wrap, loginButton);

        // Force a tight, consistent gap between signup and login regardless of Decap CSS
        loginButton.style.marginTop = '2px';
        loginButton.style.marginBottom = '0';
      }
    }
    
    // Try to inject button after page loads
    window.addEventListener('load', function() {
      // Try multiple times as DecapBridge might load async
      setTimeout(injectSignupButton, 500);
      setTimeout(injectSignupButton, 1000);
      setTimeout(injectSignupButton, 2000);
      setTimeout(injectSignupButton, 3000);
    });
    
    // Also watch for DOM changes (DecapBridge might render dynamically)
    const observer = new MutationObserver(function(mutations) {
      injectSignupButton();
    });
    
    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
  </script>
</body>
</html>
